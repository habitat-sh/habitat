sudo: required
language: rust
addons:
  apt:
    packages:
      - build-essential
      - ca-certificates
      - curl
      - file
      - gdb
      - libarchive-dev
      - libprotobuf-dev
      - libssl-dev
      - libzmq-dev
      - pkg-config
      - protobuf-compiler
      - sudo
      - tmux
      - vim
      - wget
branches:
  only:
    - master
    - auto
cache:
  apt: true
  directories:
  - $HOME/.cargo
  - components/builder-api/target
  - components/builder-dbcache/target
  - components/builder-jobsrv/target
  - components/builder-protocol/target
  - components/builder-sessionsrv/target
  - components/builder-vault/target
  - components/builder-worker/target
  - components/common/target
  - components/core/target
  - components/depot-core/target
  - components/depot-client/target
  - components/depot/target
  - components/hab/target
  - components/net/target
  - components/sodiumoxide/target
  - components/sup/target
env:
  global:
    - PATH=$HOME/.cargo/bin:$PATH
services:
- docker
before_install:
- sudo add-apt-repository -y ppa:chris-lea/libsodium
- sudo apt-get update
- sudo apt-get -y install docker iproute2 libsodium-dev man npm
- command -v protoc-gen-rust || cargo install protobuf
script:
- ./support/ci.sh
notifications:
  slack:
    secure: FjTKlrpHSKlUktFSf9W6ANmxWujelaN4bPRletBXkNwmZYwpqN1YC4lFwS16X0J6kNyvHGRva018YsUMtwI/FXtHH3YliyxCivmEoeAlZa+jMdy16pmBGhxo+mPC92SnHt1DhXfQUTstWw3h+Lq2F2MfwrB8k+nVBFJjfrF8HY0=
  webhooks: http://willem.habitat.sh:54856/travis
